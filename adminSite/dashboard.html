<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="assets/img/nur.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Universidad Nur</title>

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
    <script src="assets/js/jquery.3.2.1.min.js"></script>

    <script src="assets/js/site.js"></script>
    <link rel="stylesheet" href="../assets/sweetalert2/sweetalert2.min.css">

    <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="assets/css/animate.min.css" rel="stylesheet" />

    <!--  Light Bootstrap Table core CSS    -->
    <link href="assets/css/light-bootstrap-dashboard.css?v=1.4.0" rel="stylesheet" />


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="assets/css/pe-icon-7-stroke.css" rel="stylesheet" />
    <style>
        /* Center the loader */
        
        #loader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }
        
        #mainLoader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }
        
        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
            }
        }
        
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        /* Add animation to "page content" */
        
        .animate-bottom {
            position: relative;
            -webkit-animation-name: animatebottom;
            -webkit-animation-duration: 1s;
            animation-name: animatebottom;
            animation-duration: 1s
        }
        
        @-webkit-keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0px;
                opacity: 1
            }
        }
        
        @keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0;
                opacity: 1
            }
        }
        
        #myDiv {
            display: none;
            text-align: center;
        }
    </style>

</head>

<body>
    <input type="hidden" id="MasterPeriodoActual">
    <input type="hidden" id="hperiodoActual">
    <input type="hidden" id="dperiodoActual">
    <input type="hidden" id="firstLoad" value="">
    <div id="mainLoader"></div>
    <div id="mainContainer" class="wrapper" style="display:none">
        <div class="sidebar" data-color="purple">

            <!--

        Tip 1: you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple"
        Tip 2: you can also add an image using data-image tag

    -->

            <div class="sidebar-wrapper">
                <div class="logo">
                    <ul class="nav">
                        <a href="" class="simple-text">
                            <img style="width:90%" src="assets/img/nur.png" alt="">
                        </a>

                    </ul>
                </div>

                <ul class="nav">
                    <!-- <div style=" padding: 10px 15px;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.2);">
                        <li class="active">
                            <select id="periodosOferta" style="width:100%;margin:auto;text-align: center" class="form-control m-5 " id="selectCarrera">
                            </select>
                        </li>
                        <li class="active-pro" style="margin-top: 20px;">
                            <a id="verOferta" href="javascript:void(0)">
                                <i class="pe-7s-look"></i>
                                <p>Ver Oferta</p>
                            </a>
                        </li>
                    </div> -->
                    <br>
                    <div style=" padding: 10px 15px">
                        <!-- <h4 style="margin-left: 23%;margin-top: 0px">Carreras</h4> -->
                        <li class="active">
                            <select id="carrerasAlumno" style="width:100%;margin:auto;text-align: center" class="form-control m-5 " id="selectCarrera">
                            </select>
                        </li>
                    </div>

                    <li id="periodosTitle">
                        <h3 style="margin-left: 23%">Periodos</h3>
                    </li>

                </ul>
            </div>
        </div>

        <div class="main-panel">
            <nav class="navbar navbar-default navbar-fixed">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <p id="nombreEstudiante" class="navbar-brand" href="javascript:void(0)"></p><br>
                        <p id="periodoActual" class="navbar-brand" href="javascript:void(0)"></p>
                    </div>
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <a id="botonImprimir" href="horario.html" target="_blank">
                                    <p>Ver Horario</p>
                                </a>
                            </li>
                            <li>
                                <a href="javascript:void(0)" data-toggle="modal" data-target="#modalOferta" onclick="getElementById('bodyClick').click()">
                                    <p>Ver Oferta</p>
                                </a>
                            </li>
                            <li>
                                <a href="javascript:void(0)" data-toggle="modal" data-target="#modalCambiarPin" onclick="getElementById('bodyClick').click()">
                                    <p>Cambiar Pin</p>
                                </a>
                            </li>

                            <li>
                                <a id="logout" href="../index.html">
                                    <p>Salir</p>
                                </a>
                            </li>
                            <li class="separator hidden-lg hidden-md"></li>
                        </ul>
                    </div>
                    <!-- <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav navbar-right">
                            <li class="nav-item">
                                <a href="#" class="nav-link" data-toggle="dropdown">
                                    <i class="nc-icon nc-palette"></i>
                                    <span class="d-lg-none">Dashboard</span>
                                </a>
                            </li>
                            <li>
                                <a id="botonImprimir" href="horario.html" target="_blank" style="font-size: 18px">
                                    <span>Ver Horario</span>
                                </a>
                            </li>
                            <li>
                                <a href="javascript:void(0)" data-toggle="modal" data-target="#modalCambiarPin" style="font-size: 18px">
                                    Cambiar Pin
                                </a>
                            </li>
                            <li>
                                <a id="logout" href="../index.html" style="font-size: 18px">
                                    Salir
                                </a>
                            </li>
                            <li class="separator hidden-lg hidden-md"></li>
                        </ul>
                    </div> -->
                </div>
            </nav>
            <div class="content">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Notas</h4>
                            </div>
                            <div class="content table-responsive table-full-width">
                                <table class="table table-hover table-striped">
                                    <thead>
                                        <th>SIGLA</th>
                                        <th>MATERIA</th>
                                        <th>GRUPO</th>
                                        <th>DOCENTE</th>
                                        <th>PAR1</th>
                                        <th>PAR2</th>
                                        <th>EX.FINAL</th>
                                        <th>N.FINAL</th>
                                    </thead>
                                    <tbody id="tablaNotas">

                                    </tbody>
                                </table>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Asistencia</h4>
                            </div>
                            <div class="content table-responsive table-full-width">
                                <table class="table table-hover table-striped">
                                    <thead>
                                        <th>SIGLA</th>
                                        <th>MATERIA</th>
                                        <th>GRUPO</th>
                                        <th>DOCENTE</th>
                                        <th class="secondSemester" style="display: none">AGO</th>
                                        <th class="secondSemester" style="display: none">SEP</th>
                                        <th class="secondSemester" style="display: none">OCT</th>
                                        <th class="secondSemester" style="display: none">NOV</th>
                                        <th class="secondSemester" style="display: none">DIC</th>

                                        <th class="firstSemester" style="display: none">MAR</th>
                                        <th class="firstSemester" style="display: none">ABR</th>
                                        <th class="firstSemester" style="display: none">MAY</th>
                                        <th class="firstSemester" style="display: none">JUN</th>
                                        <th class="firstSemester" style="display: none">JUL</th>

                                        <th class="verano" style="display: none">ENE</th>
                                        <th class="verano" style="display: none">FEB</th>
                            </div>
                            </thead>
                            <tbody id="tablaAsistencia">

                            </tbody>
                            </table>

                        </div>
                    </div>
                </div>





            </div>
        </div>


        <footer class="footer">
            <div class="container-fluid">
                <!-- <nav class="pull-left">
                    <ul>
                        <li>
                            <a href="javascript:void(0)">
                                Home
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0)">
                                Company
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0)">
                                Portfolio
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0)">
                                Blog
                            </a>
                        </li>
                    </ul>
                </nav>
                <p class="copyright pull-right">
                    &copy;
                    <script>
                        document.write(new Date().getFullYear())
                    </script> <a href="http://www.creative-tim.com">Creative Tim</a>, made with love for a better web
                </p> -->
            </div>
        </footer>

    </div>
    <div id="loader" style="display:none"></div>
    </div>

    <div id="modalCambiarPin" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 style="float:left;font-weight: 450;color: #3498db" class="modal-title">Cambiar Pin</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                </div>
                <div class="modal-body">
                    <form id="formCambiarPin">
                        <div class="form-group">
                            <label for="pinAnterior">Pin Anterior</label>
                            <input type="password" class="form-control" id="pinAnterior" required>
                        </div>
                        <div class="form-group">
                            <label for="nuevoPin">Nuevo Pin</label>
                            <input type="password" class="form-control" id="nuevoPin" required>
                        </div>
                        <div class="form-group">
                            <label for="repetirNuevoPin">Vuelve a escribir tu nuevo Pin</label>
                            <input type="password" class="form-control" id="repetirNuevoPin" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>

                    </form>
                </div>
            </div>
        </div>
    </div>



    <div id="modalOferta" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 style="float:left;font-weight: 450;color: #3498db" class="modal-title">Oferta de Materias</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                </div>
                <div class="modal-body">
                    <label>Selecciona un Periodo</label>
                    <select id="periodosOferta" style="width:100%;margin:auto;text-align: center;margin-bottom: 15px" class="form-control m-5 " id="selectCarrera">
                                </select>
                    <button id='verOferta' type="button" class="btn btn-primary">Ver Oferta</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>

                </div>
            </div>
        </div>
    </div>
</body>

<!--   Core JS Files   -->
<script src="assets/js/jquery.3.2.1.min.js" type="text/javascript"></script>
<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../assets/sweetalert2/sweetalert2.min.js"></script>


<!--  Notifications Plugin    -->
<script src="assets/js/bootstrap-notify.js"></script>


<!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
<script src="assets/js/light-bootstrap-dashboard.js?v=1.4.0"></script>

<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
<script src="assets/js/demo.js"></script>

<script type="text/javascript">
    $(document).ready(function() {
        cargarPagina();
        $("#carrerasAlumno").change(function() {
            comenzarMainCargado();
            $('#firstLoad').val('1');
            cargarPagina();
        });

        function comenzarMainCargado() {
            $('#mainContainer').attr("style", 'display:none');
            $("#mainLoader").removeAttr("style");
        }

        $("#logout").click(function() {
            localStorage.removeItem("token");
        });

        $("#formCambiarPin").submit(function(event) {
            var pinAnterior = $("#pinAnterior").val();
            var nuevoPin = $("#nuevoPin").val();
            var repetirNuevoPin = $("#repetirNuevoPin").val();
            if (nuevoPin.localeCompare(repetirNuevoPin) == 0) {
                var token = localStorage.getItem("token");
                var usuario = new Object();
                usuario.pPinActual = pinAnterior;
                usuario.pPinNuevo = nuevoPin;
                $.ajax({
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + token
                    },
                    'type': 'POST',
                    'data': JSON.stringify(usuario),
                    'url': "http://sisnur.nur.edu:8085/api/Registros/UpdatePin",
                    'dataType': 'json',
                }).done(function(response) {
                    console.log(response);
                    console.log(response.Status)
                    if (response.Status) {
                        swal(
                            'Operacion Exitosa!',
                            'Pin actualizado correctamente!',
                            'success'
                        )
                    } else {
                        swal("Error", "Hubo un error al actualizar su Pin", "error")
                    }
                });
            } else {
                swal("Error", "Los Pines no son iguales.", "error")
            }
            $('#modalCambiarPin').modal('hide')
            $('#formCambiarPin')[0].reset();
            event.preventDefault();
        });



        $("#verOferta").click(function() {
            var periodoOferta = $('#periodosOferta').find(":selected").val();
            var carreraId = $('#carrerasAlumno').find(":selected").val();
            localStorage.setItem("periodoOferta", periodoOferta);
            localStorage.setItem("carreraId", carreraId);
            $('#modalOferta').modal('hide')
            window.open('oferta.html', '_blank');
        });




        $(document).on('click', '.semestre', function() {
            comenzarCargado();
            var id = parseInt(JSON.parse($(this).attr('data-json')))
            var dperiodoActual = $(this).children("p").text();
            $('#periodoActual').text(dperiodoActual);
            $('#dperiodoActual').val(dperiodoActual);
            $('#hperiodoActual').val(id);
            obtenerNotas(id);
        });

        function comenzarCargado() {
            $("#loader").removeAttr("style");
            $('.main-panel').attr("style", 'display:none');

        }

        function terminarMainCargado() {
            $('#mainLoader').attr("style", 'display:none');
            $("#mainContainer").removeAttr("style");
        }

        function terminarCargado() {
            $(".main-panel").removeAttr("style");
            $('#loader').attr("style", 'display:none');

        }

        function cargarPagina() {
            var token = localStorage.getItem("token");
            obtenerNombre(token);
            GetPeriodosCursados();
            getCarreraInfo(token);
            GetPeriodosOfertas();
        }

        function obtenerNombre(token) {
            console.log(token)
            if (token != '') {
                $.ajax({
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + token
                    },
                    'type': 'POST',
                    'url': "http://sisnur.nur.edu:8085/api/Registros/GetAlumnoInfo",
                    'dataType': 'json',
                    'success': resultado
                });
            }
        }

        function resultado(resultado) {
            console.log(resultado.Data)
            const {
                SAPELLIDOP,
                SAPELLIDOM,
                SNOMBRES
            } = resultado.Data;
            var NombreCompleto = SNOMBRES + ' ' + SAPELLIDOP + ' ' + SAPELLIDOM
            $('#nombreEstudiante').text(NombreCompleto)
        }

        function getCarreraInfo(token) {
            if (token != '') {
                jQuery.ajax({
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + token
                    },
                    'type': 'POST',
                    'url': "http://sisnur.nur.edu:8085/api/Registros/GetAlumnoCarreras",
                    'dataType': 'json',
                    'success': infoCarrera
                });
            }
        }


        function infoCarrera(resultado) {
            var count = 0;
            //$('#carrerasAlumno').empty();
            resultado.Data.forEach(function(element) {
                const {
                    LCARRERA_ID,
                    SCARRERA_DSC,
                    LPERIODOACTUAL,
                    LPERIODOACTUAL_ID
                } = element;

                $('#MasterPeriodoActual').val(LPERIODOACTUAL_ID);
                localStorage.setItem("MasterPeriodoActual", LPERIODOACTUAL_ID);
                $('#hperiodoActual').val(LPERIODOACTUAL_ID);
                $('#dperiodoActual').val(LPERIODOACTUAL)
                $('#periodoActual').text(LPERIODOACTUAL)
                if (count == 0) {
                    obtenerNotas(LPERIODOACTUAL_ID);
                    if ($('#firstLoad').val() == 1) {
                        return;
                    }
                };

                var opcion = $("<option></option>")
                opcion.attr("value", LCARRERA_ID);
                opcion.text(SCARRERA_DSC);
                $('#carrerasAlumno').append(opcion);
                count++;
            });

        }

        function GetPeriodosCursados() {
            $('.semestre').remove();
            var carreraId = $('#carrerasAlumno').find(":selected").val();
            var usuario = new Object();
            usuario.pCarreraId = carreraId;
            var token = localStorage.getItem("token");
            if (token != '') {
                jQuery.ajax({
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + token
                    },
                    'type': 'POST',
                    'url': "http://sisnur.nur.edu:8085/api/Registros/GetPeriodosCursados",
                    'dataType': 'json',
                    'data': JSON.stringify(usuario),
                    'success': periodosCursados
                });
            }
        }

        function periodosCursados(resultado) {
            resultado.Data.forEach(function(element) {
                const {
                    SPERIODO_DSC,
                    LPERIODO_ID
                } = element;
                //Menu Lateral
                var lista = $("<li></li>")
                var link = $("<a></a>")
                var parrafo = $("<p></p>").text(SPERIODO_DSC);
                parrafo.attr("class", "periodos");
                link.attr("class", "semestre");
                link.attr("data-json", LPERIODO_ID);
                link.append(parrafo);
                lista.append(link);
                $("#periodosTitle").after(lista);
            });
        }

        function GetPeriodosOfertas() {
            var carreraId = $('#carrerasAlumno').find(":selected").val();
            var usuario = new Object();
            usuario.pCarreraId = carreraId;
            var token = localStorage.getItem("token");
            if (token != '') {
                jQuery.ajax({
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + token
                    },
                    'type': 'POST',
                    'url': "http://sisnur.nur.edu:8085/api/Registros/GetPeriodosOferta",
                    'dataType': 'json',
                    'data': JSON.stringify(usuario),
                    'success': periodosOfertas
                });
            }
        }

        function periodosOfertas(resultado) {
            for (i in resultado.Data) {
                var element = resultado.Data[i];
                const {
                    SPERIODO_DSC,
                    LPERIODO_ID
                } = element;
                var opcion = $("<option></option>")
                opcion.attr("value", LPERIODO_ID);
                opcion.text(SPERIODO_DSC);
                $('#periodosOferta').append(opcion);
            }
            // resultado.Data.forEach(function(element) {
            //     const {
            //         SPERIODO_DSC,
            //         LPERIODO_ID
            //     } = element;
            //      
            //     //Menu Lateral
            //     var lista = $("<li></li>")
            //     var link = $("<a></a>")
            //     var parrafo = $("<p></p>").text(SPERIODO_DSC);
            //     parrafo.attr("class", "periodos");
            //     link.attr("class", "semestre");
            //     link.attr("data-json", LPERIODO_ID);
            //     link.append(parrafo);
            //     lista.append(link);
            //     $("#SPERIODO_DSC").after(lista);

            // });
        }

        function obtenerNotas(periodoId) {
            var periodoActual = $('#dperiodoActual').val();
            var semestre = periodoActual.split("-")[1];
            mostrarColumnas(semestre);
            var token = localStorage.getItem("token");
            var carreraId = $('#carrerasAlumno').find(":selected").val();
            var userId = localStorage.getItem("idUser");
            var usuario = new Object();
            usuario.pCarreraId = carreraId;
            usuario.pPeriodoId = periodoId;
            if (userId != '') {
                jQuery.ajax({
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + token
                    },
                    'type': 'POST',
                    'data': JSON.stringify(usuario),
                    'url': "http://sisnur.nur.edu:8085/api/Registros/GetNotasFaltas",
                    'dataType': 'json',
                    'success': cargarNotas
                });
            }
        }

        function mostrarColumnas(semestre) {
            switch (semestre) {
                case '1':
                    $(".firstSemester").removeAttr("style");
                    if (!$('.secondSemester')[0].hasAttribute('style')) {
                        $('.secondSemester').attr("style", 'display:none');
                    }
                    if (!$('.verano')[0].hasAttribute('style')) {
                        $('.verano').attr("style", 'display:none');
                    }
                    break;
                case '2':
                    $(".secondSemester").removeAttr("style");
                    if (!$('.firstSemester')[0].hasAttribute('style')) {
                        $('.firstSemester').attr("style", 'display:none');
                    }
                    if (!$('.verano')[0].hasAttribute('style')) {
                        $('.verano').attr("style", 'display:none');
                    }
                    break;
                case 'V':
                    $(".verano").removeAttr("style");
                    if (!$('.secondSemester')[0].hasAttribute('style')) {
                        $('.secondSemester').attr("style", 'display:none');
                    }
                    if (!$('.firstSemester')[0].hasAttribute('style')) {
                        $('.firstSemester').attr("style", 'display:none');
                    }
                    break;
            }
        }

        function cargarNotas(resultado) {
            $('#tablaNotas').empty();
            $('#tablaAsistencia').empty();
            resultado.Data.forEach(function(element) {
                const {
                    SCODMATERIA,
                    SSIGLA,
                    DOCENTE,
                    EXFINAL,
                    FINAL,
                    PAR1,
                    PAR2,
                    SMATERIA_DSC,
                    LCENTRO_ID
                } = element;
                var tr = $("<tr ></tr>")
                var tdCodMateria = $("<td></td>").text(SCODMATERIA);
                var tdMateria = $("<td></td>").text(SMATERIA_DSC);
                var tdCodgrupo = $("<td></td>").text(SSIGLA);
                var tdDocente = $("<td></td>").text(DOCENTE);
                var tdExFinal = $("<td></td>").text(EXFINAL);
                var tdFinal = $("<td></td>").text(FINAL);
                var tdPar1 = $("<td></td>").text(PAR1);
                var tdPar2 = $("<td></td>").text(PAR2);
                tr.append(tdCodMateria)
                tr.append(tdMateria)
                tr.append(tdCodgrupo)
                tr.append(tdDocente)
                tr.append(tdPar1)
                tr.append(tdPar2)
                tr.append(tdExFinal)
                tr.append(tdFinal)
                $('#tablaNotas').append(tr);
                cargarAsistencias(element)


            });
        }

        function cargarAsistencias(element) {
            const {
                SCODMATERIA,
                SSIGLA,
                DOCENTE,
                SMATERIA_DSC,
                LCENTRO_ID
            } = element;
            var tr = $("<tr ></tr>")
            var tdCodMateria = $("<td></td>").text(SCODMATERIA);
            var tdMateria = $("<td></td>").text(SMATERIA_DSC);
            var tdCodgrupo = $("<td></td>").text(SSIGLA);
            var tdDocente = $("<td></td>").text(DOCENTE);
            tr.append(tdCodMateria)
            tr.append(tdMateria)
            tr.append(tdCodgrupo)
            tr.append(tdDocente)
            var periodoActual = $('#dperiodoActual').val();
            var semestre = periodoActual.split("-")[1];

            var count = 0;
            switch (semestre) {
                case '1':
                    const {
                        FMES3,
                        FMES4,
                        FMES5,
                        FMES6,
                        FMES7
                    } = element;
                    var tdFMES3 = $("<td></td>").text(FMES3);
                    var tdFMES4 = $("<td></td>").text(FMES4);
                    var tdFMES5 = $("<td></td>").text(FMES5);
                    var tdFMES6 = $("<td></td>").text(FMES6);
                    var tdFMES7 = $("<td></td>").text(FMES7);
                    tr.append(tdFMES3)
                    tr.append(tdFMES4)
                    tr.append(tdFMES5)
                    tr.append(tdFMES6)
                    tr.append(tdFMES7)
                    count = FMES3 + FMES4 + FMES5 + FMES6 + FMES7
                    if (LCENTRO_ID == 1) {
                        if (count == 3 || count == 4) {
                            tr.css("background-color", "yellow");
                        } else if (count == 5) {
                            tr.css("background-color", "red");
                        } else if (count > 5) {
                            tr.css("background-color", "black");
                            tr.css("color", "white");
                        }
                    } else if (LCENTRO_ID == 2) {
                        if (count == 1) {
                            tr.css("background-color", "yellow");
                        } else if (count == 2) {
                            tr.css("background-color", "red");
                        } else if (count > 2) {
                            tr.css("background-color", "black");
                            tr.css("color", "white");
                        }
                    }

                    break;
                case '2':
                    const {
                        FMES8,
                        FMES9,
                        FMES10,
                        FMES11,
                        FMES12
                    } = element;
                    var tdFMES8 = $("<td></td>").text(FMES8);
                    var tdFMES9 = $("<td></td>").text(FMES9);
                    var tdFMES10 = $("<td></td>").text(FMES10);
                    var tdFMES11 = $("<td></td>").text(FMES11);
                    var tdFMES12 = $("<td></td>").text(FMES12);
                    tr.append(tdFMES8)
                    tr.append(tdFMES9)
                    tr.append(tdFMES10)
                    tr.append(tdFMES11)
                    tr.append(tdFMES12)
                    count = FMES8 + FMES9 + FMES10 + FMES11 + FMES12
                    if (LCENTRO_ID == 1) {
                        if (count == 3 || count == 4) {
                            tr.css("background-color", "yellow");
                        } else if (count == 5) {
                            tr.css("background-color", "red");
                        } else if (count > 5) {
                            tr.css("background-color", "black");
                            tr.css("color", "white");
                        }
                    } else if (LCENTRO_ID == 2) {
                        if (count == 1) {
                            tr.css("background-color", "yellow");
                        } else if (count == 2) {
                            tr.css("background-color", "red");
                        } else if (count > 2) {
                            tr.css("background-color", "black");
                            tr.css("color", "white");
                        }
                    }
                    break;
                case 'V':
                    const {
                        FMES1,
                        FMES2
                    } = element;
                    var tdFMES1 = $("<td></td>").text(FMES1);
                    var tdFMES2 = $("<td></td>").text(FMES2);
                    tr.append(tdFMES1)
                    tr.append(tdFMES2)
                    count = FMES1 + FMES2
                    if (LCENTRO_ID == 1) {
                        if (count == 3 || count == 4) {
                            tr.css("background-color", "yellow");
                        } else if (count == 5) {
                            tr.css("background-color", "red");
                        } else if (count > 5) {
                            tr.css("background-color", "black");
                            tr.css("color", "white");
                        }
                    } else if (LCENTRO_ID == 2) {
                        if (count == 1) {
                            tr.css("background-color", "yellow");
                        } else if (count == 2) {
                            tr.css("background-color", "red");
                        } else if (count > 2) {
                            tr.css("background-color", "black");
                            tr.css("color", "white");
                        }
                    }
                    break;

            }
            $('#tablaAsistencia').append(tr);
            terminarCargado();
            terminarMainCargado();

        }


    });
</script>

</html>